<h4 class='mt-4 text-center'>Import Offenses from Excel</h4>

<div class='card bg-light col-10 rounded mb-2 shadow mx-auto border-info'>
  <div class='card-body'>
    Note: The application will read your spreadsheet and attempt to find the
    objects by their IDs. It updates the record if it finds one, else, it creates a new record if the ID does not exist.
  </div>
</div>

<h4 class='text-center'>Requirements</h4>
<div class='card bg-light col-10 rounded mb-2 shadow mx-auto border-info'>
  <div class='card-body'>
    <ul>
      <li>Do not change existing IDs. Add new IDs in chronological order.</li>
      <li>Only import spreadsheets that were previously downloaded from this
          application; others cannot be read correctly.</li>
    </ul>
  </div>
</div>

<h5 class='text-center'>Select File</h5>
<div class='card bg-light col-10 rounded mb-2 shadow mx-auto border-info'>
  <div class='card-body'>
    <%= form_for @offense_import do |f| %>
      <% if @offense_import.errors.any? %>
        <%= pluralize(@offense_import.errors.count, "error") %> prevented us from
            importing your spreadsheet. Please update your spreadsheet and try again.
          <ul>
            <% @offense_import.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
      <% end %>

      <%= f.file_field :file %>
      <%= f.submit "Import File", class: "btn btn-primary" %>
    <% end %>
  </div>
</div>

<div class='text-center'>
    <%= link_to "Back", :back, class: 'btn btn-info mt-2' %>
</div>
